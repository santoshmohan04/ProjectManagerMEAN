<div class="container py-4">
  <form [formGroup]="projectForm" (ngSubmit)="addorUpdateProject()" novalidate>
    <div class="mb-3 d-flex align-items-center">
      <label for="projectName" class="me-3 fw-bold">Project Name:</label>
      <input
        type="text"
        class="form-control flex-grow-1"
        formControlName="projectName"
      />
    </div>

    <div class="mb-3 d-flex align-items-center">
      <input type="checkbox" class="me-2" formControlName="setDates" />
      <label for="setDates">Set Start and End Date</label>
    </div>

    <div class="d-flex gap-3">
      <input
        type="text"
        class="form-control"
        placeholder="Start Date"
        formControlName="startDate"
        ngbDatepicker
        #startDatePicker="ngbDatepicker"
        (focus)="startDatePicker.toggle()"
      />
      <input
        type="text"
        class="form-control"
        placeholder="End Date"
        formControlName="endDate"
        ngbDatepicker
        #endDatePicker="ngbDatepicker"
        (focus)="endDatePicker.toggle()"
      />
    </div>

    <div class="my-3 d-flex align-items-center">
      <label for="priority" class="me-3 fw-bold">Priority:</label>
      <input
        type="range"
        min="0"
        max="30"
        class="form-range"
        formControlName="priority"
        name="priority"
        (input)="updateRange($event)"
      />
    </div>

    <div class="d-flex gap-3 align-items-center">
      <label for="manager" class="fw-bold">Manager:</label>
      <input
        type="text"
        class="form-control flex-grow-1"
        formControlName="managername"
        readonly
      />
      <button
        type="button"
        class="btn btn-outline-primary"
        (click)="openUsersModal()"
      >
        <i class="fa fa-search"></i> Search
      </button>
    </div>

    <div class="mt-4 text-end">
      <button
        type="submit"
        [disabled]="projectForm.invalid"
        class="btn btn-primary me-2"
      >
        {{ userAction }}
      </button>
      <button type="button" class="btn btn-secondary" (click)="reset()">
        Reset
      </button>
    </div>
  </form>

  <hr class="my-4" />

  <div class="mb-3">
    <input
      type="text"
      class="form-control"
      placeholder="Search..."
      (input)="search($event)"
    />
  </div>

  <div class="d-flex gap-2 align-items-center">
    <span class="fw-bold">Sort By:</span>
    <button
      *ngFor="
        let field of ['Start_Date', 'End_Date', 'Priority', 'CompletedTasks']
      "
      type="button"
      class="btn btn-secondary"
      [disabled]="Projects?.length === 0"
      (click)="sort(field)"
    >
      {{ field.replace("_", " ") }}
    </button>
  </div>

  <div class="mt-4">
    <div
      *ngFor="let project of Projects"
      class="border rounded p-3 mb-3 bg-light"
    >
      <div class="d-flex justify-content-between">
        <div>
          <h5>{{ project.Project }}</h5>
          <p class="mb-1">
            Tasks: {{ project?.NoOfTasks }}, Completed:
            {{ project?.CompletedTasks }}
          </p>
          <p class="mb-0">
            Start: {{ project.Start_Date | date : "dd-MM-yyyy" }}, End:
            {{ project.End_Date | date : "dd-MM-yyyy" }}
          </p>
        </div>
        <div>
          <p class="fw-bold text-center">Priority</p>
          <div class="border rounded bg-white text-center p-2">
            <span>{{ project.Priority }}</span>
          </div>
        </div>
        <div class="d-flex flex-column gap-2">
          <button
            type="button"
            class="btn btn-outline-primary"
            (click)="editProject(project.Project_ID)"
          >
            Update
          </button>
          <button
            type="button"
            class="btn btn-outline-danger"
            (click)="suspendProject(project.Project_ID)"
          >
            Suspend
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
